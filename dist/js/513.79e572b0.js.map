{"version":3,"file":"js/513.79e572b0.js","mappings":"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","sources":["webpack://lite/./src/views/coll/more.vue","webpack://lite/src/views/coll/more.vue","webpack://lite/./src/views/coll/more.vue?2fd0","webpack://lite/./src/views/coll/more.vue?ddbe","webpack://lite/./src/bridge/collection/delete.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('lay-header',{attrs:{\"showBack\":!_vm.isEditMode,\"showX\":_vm.isEditMode,\"tBarColor\":\"#FFFFFF\",\"txtRight\":_vm.isEditMode ? _vm.$t('common.done') : _vm.$t('common.edit'),\"txtTitle\":_vm.$t('collection.title'),\"onBack\":() => {\n      if (_vm.isEditMode) {\n        _vm.isEditMode = false;\n      } else {\n        _vm.$router.go(-1);\n      }\n    },\"onRight\":_vm.onClickActionEdit}},[_c('v-layout',{staticClass:\"pt-1 px-5 pb-13 lay-body\",attrs:{\"column\":\"\"}},[_c('v-layout',{staticClass:\"lay-pics\",attrs:{\"row\":\"\",\"wrap\":\"\"}},[_vm._l((_vm.items),function(item,index){return _c('c-coll',{key:index,attrs:{\"name\":item.favorite == 1 ? _vm.$t('collection.like') : item.collectionName,\"src\":item.thumbName + `?${_vm.filterVer}`,\"isEditMode\":item.favorite == 1 ? false : _vm.isEditMode,\"onDel\":() => _vm.onClickActionDel(item),\"onClick\":() => {\n            if (!_vm.isEditMode)\n              _vm.pushRouter({\n                name: 'collList',\n                params: { seq: item.collectionId },\n              });\n          }}},[(item.favorite == 1)?_c('img',{staticClass:\"ic-heart\",attrs:{\"src\":require(\"@/assets/images/ic-heart-w.svg\")}}):_vm._e()])}),_c('c-coll',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isEditMode),expression:\"!isEditMode\"}],attrs:{\"name\":_vm.$t('collection.reg'),\"onClick\":() => _vm.pushRouter({ name: 'collReg' }),\"empty\":true}},[_c('v-layout',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"lay-add\",attrs:{\"align-center\":\"\",\"justify-center\":\"\"}},[_c('img',{attrs:{\"src\":require(\"@/assets/images/ic-plus-g.svg\")}})])],1)],2)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <lay-header\n    :showBack=\"!isEditMode\"\n    :showX=\"isEditMode\"\n    tBarColor=\"#FFFFFF\"\n    :txtRight=\"isEditMode ? $t('common.done') : $t('common.edit')\"\n    :txtTitle=\"$t('collection.title')\"\n    :onBack=\"\n      () => {\n        if (isEditMode) {\n          isEditMode = false;\n        } else {\n          $router.go(-1);\n        }\n      }\n    \"\n    :onRight=\"onClickActionEdit\"\n  >\n    <v-layout column class=\"pt-1 px-5 pb-13 lay-body\">\n      <v-layout row wrap class=\"lay-pics\">\n        <c-coll\n          v-for=\"(item, index) in items\"\n          :key=\"index\"\n          :name=\"\n            item.favorite == 1 ? $t('collection.like') : item.collectionName\n          \"\n          :src=\"item.thumbName + `?${filterVer}`\"\n          :isEditMode=\"item.favorite == 1 ? false : isEditMode\"\n          :onDel=\"() => onClickActionDel(item)\"\n          :onClick=\"\n            () => {\n              if (!isEditMode)\n                pushRouter({\n                  name: 'collList',\n                  params: { seq: item.collectionId },\n                });\n            }\n          \"\n        >\n          <img\n            v-if=\"item.favorite == 1\"\n            class=\"ic-heart\"\n            src=\"@/assets/images/ic-heart-w.svg\"\n          />\n        </c-coll>\n        <c-coll\n          v-show=\"!isEditMode\"\n          :name=\"$t('collection.reg')\"\n          :onClick=\"() => pushRouter({ name: 'collReg' })\"\n          :empty=\"true\"\n        >\n          <v-layout class=\"lay-add\" align-center justify-center v-ripple>\n            <img src=\"@/assets/images/ic-plus-g.svg\" />\n          </v-layout>\n        </c-coll>\n      </v-layout>\n    </v-layout>\n  </lay-header>\n</template>\n\n<script>\nimport CColl from \"@/components/cColl.vue\";\nimport COLL_LIST from \"@/bridge/collection/list\";\nimport COLL_DEL from \"@/bridge/collection/delete\";\nexport default {\n  components: { CColl },\n  data() {\n    return {\n      isEditMode: false,\n      isGetingItems: false,\n      items: [],\n      pageNo: 1,\n      allCount: 0,\n    };\n  },\n  computed: {},\n  watch: {},\n  created() {\n    window.addEventListener(\"scroll\", this.handleScroll);\n  },\n  mounted() {\n    this.getItems();\n  },\n  destroyed() {\n    window.removeEventListener(\"scroll\", this.handleScroll);\n  },\n  methods: {\n    async getItems(page = 1) {\n      if (this.isGetingItems) {\n        return;\n      }\n      this.isGetingItems = true;\n      await COLL_LIST.request(page)\n        .then((data) => {\n          this.isGetingItems = false;\n          this.pageNo = page;\n          if (page == 1) {\n            this.items.splice(0, this.items.length);\n            this.allCount = 0;\n            if (\n              data.list &&\n              data.list.length == 1 &&\n              data.list[0].favorite == \"1\" &&\n              !data.list[0].mediaId\n            ) {\n              return;\n            }\n          }\n          this.allCount = data.allCount;\n          this.items.push(...data.list);\n          setTimeout(() => {\n            var target = document.children[0];\n            this.checkNext(target);\n          }, 300);\n        })\n        .catch(() => {\n          this.isGetingItems = false;\n        });\n    },\n    handleScroll(event) {\n      let target = event.target.children[0];\n      this.checkNext(target);\n    },\n    checkNext(target) {\n      if (\n        this.items.length < this.allCount &&\n        target &&\n        target.scrollHeight - target.clientHeight - 80 < target.scrollTop\n      ) {\n        this.getItems(this.pageNo + 1);\n      }\n    },\n\n    onClickActionEdit() {\n      this.isEditMode = !this.isEditMode;\n      if (!this.isEditMode) {\n        this.getItems();\n      }\n    },\n\n    async onClickActionDel(item) {\n      if (this.isGetingItems) {\n        return;\n      }\n      this.isGetingItems = true;\n      let res = await COLL_DEL.request([item.collectionId]);\n      this.isGetingItems = false;\n      if (res.isSuccess) {\n        this.items.splice(this.items.indexOf(item), 1);\n        this.showToast(this.$t(\"error.del-comp\"));\n      } else {\n        this.showToast(this.$t(\"error.error\"), false, false);\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/sass/app.scss\";\n.lay-body {\n  .lay-pics {\n    margin: 0 -4px;\n    flex: none;\n    & > * {\n      padding: 0 4px;\n      margin-top: pxToRem(18px);\n      flex: none;\n      .ic-heart {\n        width: 24px;\n        height: 24px;\n        position: absolute;\n        left: 12px;\n        bottom: 12px;\n      }\n    }\n    .lay-add {\n      width: 100%;\n      height: 100%;\n      background: white;\n      border: 1px solid #ced4da;\n      border-radius: pxToRem(8px);\n      img {\n        width: pxToRem(32px);\n        height: pxToRem(32px);\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./more.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./more.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./more.vue?vue&type=template&id=7aff82f8&scoped=true\"\nimport script from \"./more.vue?vue&type=script&lang=js\"\nexport * from \"./more.vue?vue&type=script&lang=js\"\nimport style0 from \"./more.vue?vue&type=style&index=0&id=7aff82f8&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7aff82f8\",\n  null\n  \n)\n\nexport default component.exports","import uuid from \"uuid\";\nimport nativeBridge from \"@/plugins/nativeBridge\";\nconst bridge = {\n    request: async (seqs) => {\n        let retData = {\n            isSuccess: false,\n            errorMsg: '',\n            data: null,\n        };\n\n        if(!seqs.length) {\n            throw 'no data'\n        }\n\n        let query = `   \n            DELETE FROM \n                TB_COLLECTION\n            WHERE\n                collectionId IN (${seqs})\n        `\n        try {\n            var res = await new Promise((resolve, reject) => {\n                const callbackUUID = `API_GETINFO_CALLBACK_${uuid().replace(/-/gi, \"\")}`;\n                nativeBridge.sqlite(JSON.stringify({ cmd: \"runQuery\", query: query }), callbackUUID)\n                window[`${callbackUUID}`] = (value) => {\n                    try {\n                        if (value) {\n                            resolve(value);\n                        } else {\n                            reject();\n                        }\n                    } catch (error) {\n                        reject(error);\n                    }\n                    delete window[`${callbackUUID}`];\n                };\n            });\n            if (JSON.parse(res).result) {\n                return new Promise((resolve, reject) => {\n                    let q = `\n                        DELETE FROM \n                            TB_COLLECTION_MEDIA \n                        WHERE \n                            collectionId IN (${seqs})\n                    `\n                    const callbackUUID = `API_GETID_CALLBACK_${uuid().replace(/-/gi, \"\")}`;\n                    nativeBridge.sqlite(JSON.stringify({ cmd: \"runQuery\", query: q }), callbackUUID)\n                    window[`${callbackUUID}`] = (value) => {\n                        try {\n                            if (value) {\n                                const ret = JSON.parse(value);\n                                retData.isSuccess = ret.result\n                                retData.errorMsg = ret.error\n                                retData.data = ret.data && ret.data.length > 0 ? ret.data[0] : null\n                                resolve(retData);\n                            } else {\n                                reject();\n                            }\n                        } catch (error) {\n                            reject(error);\n                        }\n                        delete window[`${callbackUUID}`];\n                    };\n                })\n            } else {\n                throw 'error'\n            }\n        } catch (error) {\n            throw error\n        }\n    }\n}\nexport default bridge"],"names":["attrs","_vm","isEditMode","$router","onClickActionEdit","staticClass","favorite","onClickActionDel","item","pushRouter","seq","collectionId","_e","name","rawName","expression","$t","directives","staticRenderFns","components","CColl","data","isGetingItems","items","pageNo","allCount","computed","watch","created","window","addEventListener","handleScroll","mounted","getItems","destroyed","removeEventListener","methods","page","COLL_LIST","request","then","splice","length","list","mediaId","push","setTimeout","target","document","children","checkNext","catch","event","scrollHeight","clientHeight","scrollTop","res","COLL_DEL","isSuccess","indexOf","showToast","component","render","bridge","async","retData","errorMsg","seqs","query","Promise","resolve","reject","callbackUUID","uuid","replace","nativeBridge","sqlite","JSON","stringify","cmd","value","error","parse","result","q","ret"],"sourceRoot":""}