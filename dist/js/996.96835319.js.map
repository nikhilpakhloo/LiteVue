{"version":3,"file":"js/996.96835319.js","mappings":"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","sources":["webpack://lite/./src/views/gallery/pics.vue","webpack://lite/src/views/gallery/pics.vue","webpack://lite/./src/views/gallery/pics.vue?f706","webpack://lite/./src/views/gallery/pics.vue?d71d","webpack://lite/./src/bridge/media/list.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('lay-header',{attrs:{\"showBack\":true,\"tBarColor\":\"#FFFFFF\",\"txtTitle\":_vm.$t('gallery.my-pic'),\"onRight\":_vm.onClickActionComp,\"isGetingItems\":_vm.isGetingItems}},[_c('v-layout',{staticClass:\"bar-right\",attrs:{\"slot\":\"right\"},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.onClickActionFilter.apply(null, arguments)}},slot:\"right\"},[_c('img',{attrs:{\"src\":require(\"@/assets/images/ic-pen-b.svg\")}}),_c('span',{staticClass:\"txt-right\"},[_vm._v(_vm._s(_vm.$t(\"common.btn-filter\")))])]),_c('v-layout',{staticClass:\"lay-body\",attrs:{\"column\":\"\"}},[(_vm.selectItems.length)?[_c('span',{staticClass:\"px-5 my-2 txt-cnt\"},[_vm._v(_vm._s(_vm.$t(\"gallery.sel-cnt\", { count: _vm.selectItems.length })))]),_c('v-layout',{staticClass:\"lay-select\"},_vm._l((_vm.selectItems),function(item,index){return _c('v-img',{key:index,staticClass:\"img-select\",attrs:{\"width\":64,\"height\":64,\"max-width\":64,\"max-height\":64,\"src\":item.thumbName + `?${_vm.filterVer}`}},[_c('img',{staticClass:\"ic-x\",attrs:{\"src\":require(\"@/assets/images/ic-x-thumb.svg\")},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return (() => {\n                _vm.selectItems.splice(index, 1);\n              }).apply(null, arguments)}}})])}),1)]:_vm._e(),_c('v-layout',{staticClass:\"flex-grow-0 pb-5 mt-3\",attrs:{\"wrap\":\"\",\"row\":\"\"}},_vm._l((_vm.items),function(item,index){return _c('c-pic',{key:index,attrs:{\"editMode\":true,\"src\":(item.fileType == 'VIDEO' ? item.thumbName : item.fileName) + `?${_vm.filterVer}`,\"isVideo\":item.fileType == 'VIDEO',\"duration\":item.videoTime,\"select\":_vm.selectItems.indexOf(item) > -1\n            ? _vm.selectItems.indexOf(item) + 1\n            : null,\"onClick\":() => _vm.onClickActionSelect(item),\"mediaId\":item.mediaId,\"isLike\":item.likeYn == 'Y',\"isFilter\":item.filterd == '1',\"isMemo\":item.memo.title || item.memo.memo}})}),1)],2)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <lay-header\n    :showBack=\"true\"\n    tBarColor=\"#FFFFFF\"\n    :txtTitle=\"$t('gallery.my-pic')\"\n    :onRight=\"onClickActionComp\"\n    :isGetingItems=\"isGetingItems\"\n  >\n    <v-layout\n      class=\"bar-right\"\n      slot=\"right\"\n      @click.prevent.stop=\"onClickActionFilter\"\n    >\n      <img src=\"@/assets/images/ic-pen-b.svg\" />\n      <span class=\"txt-right\">{{ $t(\"common.btn-filter\") }}</span>\n    </v-layout>\n    <v-layout column class=\"lay-body\">\n      <template v-if=\"selectItems.length\">\n        <span class=\"px-5 my-2 txt-cnt\">{{\n          $t(\"gallery.sel-cnt\", { count: selectItems.length })\n        }}</span>\n        <v-layout class=\"lay-select\">\n          <v-img\n            class=\"img-select\"\n            v-for=\"(item, index) in selectItems\"\n            :key=\"index\"\n            :width=\"64\"\n            :height=\"64\"\n            :max-width=\"64\"\n            :max-height=\"64\"\n            :src=\"item.thumbName + `?${filterVer}`\"\n          >\n            <img\n              src=\"@/assets/images/ic-x-thumb.svg\"\n              class=\"ic-x\"\n              @click.prevent.stop=\"\n                () => {\n                  selectItems.splice(index, 1);\n                }\n              \"\n            />\n          </v-img>\n        </v-layout>\n      </template>\n      <v-layout wrap row class=\"flex-grow-0 pb-5 mt-3\">\n        <c-pic\n          v-for=\"(item, index) in items\"\n          :editMode=\"true\"\n          :key=\"index\"\n          :src=\"(item.fileType == 'VIDEO' ? item.thumbName : item.fileName) + `?${filterVer}`\"\n          :isVideo=\"item.fileType == 'VIDEO'\"\n          :duration=\"item.videoTime\"\n          :select=\"\n            selectItems.indexOf(item) > -1\n              ? selectItems.indexOf(item) + 1\n              : null\n          \"\n          :onClick=\"() => onClickActionSelect(item)\"\n          :mediaId=\"item.mediaId\"\n          :isLike=\"item.likeYn == 'Y'\"\n          :isFilter=\"item.filterd == '1'\"\n          :isMemo=\"item.memo.title || item.memo.memo\"\n        />\n      </v-layout>\n    </v-layout>\n  </lay-header>\n</template>\n\n<script>\nimport CPic from \"../../components/cPic.vue\";\nimport MEDIA_LIST from \"@/bridge/media/list\";\nexport default {\n  props: [\"title\"],\n  components: { CPic },\n  data() {\n    return {\n      selectItems: [],\n      items: [],\n      pageNo: 1,\n      allCount: 0,\n      isGetingItems: false,\n    };\n  },\n  computed: {},\n  watch: {},\n  created() {\n    window.addEventListener(\"scroll\", this.handleScroll);\n    window.onFilterComplete = (res) => {\n      if(res) {\n        this.showToast(this.$t(\"error.filter-comp\"), false, false);\n        this.$store.commit(\"filterVer\", this.filterVer + 1);\n        this.$router.go(-1);\n      }else{\n        \n      }\n    };\n  },\n  mounted() {\n    this.getItems();\n  },\n  destroyed() {\n    window.removeEventListener(\"scroll\", this.handleScroll);\n    delete window.onFilterComplete;\n  },\n  methods: {\n    async getItems(page = 1) {\n      if (this.isGetingItems) {\n        return;\n      }\n      this.isGetingItems = true;\n      this.pageNo = page;\n      await MEDIA_LIST.request(this.pageNo)\n        .then((data) => {\n          if (this.pageNo == 1) {\n            this.items.splice(0, this.items.length);\n          }\n          this.items.push(...data.list);\n          this.allCount = data.allCount;\n          this.isGetingItems = false;\n\n          this.items.forEach(element => {\n            try {\n              this.$set(element, 'memo', JSON.parse(element.memo.replace(/\\n/g, \"\\\\n\")))\n            } catch (error) {\n            }\n          });\n\n          setTimeout(() => {\n            var target = document.children[0];\n            this.checkNext(target);\n          }, 300);\n        })\n        .catch(() => {\n          this.isGetingItems = false;\n        });\n    },\n    handleScroll(event) {\n      let target = event.target.children[0];\n      this.checkNext(target);\n    },\n    checkNext(target) {\n      if (\n        this.items.length < this.allCount &&\n        target &&\n        target.scrollHeight - target.clientHeight - 80 < target.scrollTop\n      ) {\n        this.getItems(this.pageNo + 1);\n      }\n    },\n    onClickActionComp() {\n      this.showToast(\"준비중입니다.\");\n      this.pushRouter({\n        name: \"collList\",\n        params: {\n          seq: 1,\n        },\n      });\n    },\n    onClickActionSelect(item) {\n      if (this.selectItems.indexOf(item) > -1) {\n        this.selectItems.splice(this.selectItems.indexOf(item), 1);\n      } else {\n        this.selectItems.push(item);\n      }\n    },\n    onClickActionFilter() {\n      if (this.selectItems.length > this.FILTER_MAX_SIZE) {\n        this.showToast(\n          this.$t(\"error.filter-cnt-error\", { count: this.FILTER_MAX_SIZE }),\n          false,\n          false\n        );\n        return;\n      }\n      this.nativeBridge.showFilterView(this.selectItems, \"onFilterComplete\");\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/sass/app.scss\";\n.bar-right {\n  flex: none;\n  z-index: 1;\n  img {\n    width: pxToRem(16px);\n    height: pxToRem(16px);\n  }\n  .txt-right {\n    margin-left: 2px;\n    font-style: normal;\n    font-weight: 700;\n    font-size: pxToRem(16px);\n    line-height: pxToRem(20px);\n    text-align: center;\n    letter-spacing: -0.022em;\n    color: #000000;\n  }\n}\n.lay-body {\n  .txt-cnt {\n    font-style: normal;\n    font-weight: 400;\n    font-size: pxToRem(14px);\n    line-height: pxToRem(16px);\n    letter-spacing: -0.022em;\n    color: #000000;\n  }\n  .lay-select {\n    overflow-x: auto;\n    padding: pxToRem(4px) pxToRem(20px) pxToRem(20px);\n    flex: none;\n    .img-select {\n      border-radius: 8px;\n      position: relative;\n      .ic-x {\n        position: absolute;\n        width: 28px;\n        height: 28px;\n        padding: 6px;\n        right: 0;\n      }\n    }\n    & > * + * {\n      margin-left: 6px;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./pics.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./pics.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./pics.vue?vue&type=template&id=321a4550&scoped=true\"\nimport script from \"./pics.vue?vue&type=script&lang=js\"\nexport * from \"./pics.vue?vue&type=script&lang=js\"\nimport style0 from \"./pics.vue?vue&type=style&index=0&id=321a4550&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"321a4550\",\n  null\n  \n)\n\nexport default component.exports","import uuid from \"uuid\";\nimport nativeBridge from \"@/plugins/nativeBridge\";\nimport allCount from \"../count\";\n\nconst bridge = {\n    request: async (pageNo = 1, pageSize = 20, equals, excColId) => {\n        let retData = {\n            isSuccess: false,\n            errorMsg: '',\n            list: null,\n            allCount: 0\n        };\n        let cq = `\n            SELECT \n                COUNT(*) AS cnt \n            FROM \n                TB_MEDIA \n            WHERE \n                deleted = 0\n        `\n        let query = `\n            SELECT \n               *\n            FROM \n               (\n                    SELECT \n                        m.*,\n                        CASE WHEN(COUNT(cm.collectionMediaId) > 0) THEN 'Y' ELSE 'N' END as likeYn\n                    FROM \n                        TB_MEDIA m\n                    LEFT JOIN\n                        TB_COLLECTION_MEDIA cm\n                    ON\n                        m.mediaId = cm.mediaId \n                        AND cm.collectionId = 1 \n                        AND cm.deleted = 0\n                    GROUP BY\n                        m.mediaId\n                )\n            WHERE \n                deleted = 0\n        `\n\n        if (equals && equals.length) {\n            equals.forEach(element => {\n                query += ` AND ${element.key} = '${element.val}' `\n                cq += ` AND ${element.key} = '${element.val}' `\n            });\n        }\n\n        if (excColId) {\n            let eq = `\n                AND mediaId NOT IN (\n                    SELECT \n                        mediaId\n                    FROM\n                        TB_COLLECTION_MEDIA\n                    WHERE \n                        deleted = 0\n                    AND \n                        collectionId = ${excColId}\n                )\n            `\n            query += eq;\n            cq += eq;\n        }\n        query += `   \n            ORDER BY \n                createDate DESC\n            LIMIT ${pageSize} OFFSET ${pageSize * (pageNo - 1)}\n        `\n        try {\n            retData.allCount = await allCount.request(cq, \"cnt\")\n        } catch (error) {\n            return Promise.reject(error)\n        }\n        return new Promise((resolve, reject) => {\n            const callbackUUID = `API_GETLIST_CALLBACK_${uuid().replace(/-/gi, \"\")}`;\n            nativeBridge.sqlite(JSON.stringify({ cmd: \"selectQuery\", query: query }), callbackUUID)\n            window[`${callbackUUID}`] = (value) => {\n                try {\n                    if (value) {\n                        const ret = JSON.parse(value);\n                        retData.isSuccess = ret.result\n                        retData.errorMsg = ret.error\n                        retData.list = ret.data\n                        resolve(retData);\n                    } else {\n                        reject();\n                    }\n                } catch (error) {\n                    reject(error);\n                }\n                delete window[`${callbackUUID}`];\n            };\n        });\n    }\n}\nexport default bridge"],"names":["attrs","_vm","_c","staticClass","on","$event","onClickActionFilter","selectItems","count","length","item","require","apply","indexOf","onClickActionSelect","onClick","mediaId","filterd","memo","render","props","components","CPic","data","items","pageNo","allCount","isGetingItems","computed","watch","created","window","addEventListener","handleScroll","onFilterComplete","res","showToast","$t","$store","commit","filterVer","$router","go","mounted","getItems","destroyed","removeEventListener","methods","page","MEDIA_LIST","request","then","splice","push","list","forEach","element","$set","JSON","parse","replace","error","setTimeout","target","document","children","checkNext","catch","event","scrollHeight","clientHeight","scrollTop","onClickActionComp","pushRouter","name","params","seq","FILTER_MAX_SIZE","nativeBridge","showFilterView","component","staticRenderFns","bridge","async","pageSize","equals","excColId","retData","isSuccess","errorMsg","cq","query","key","val","eq","Promise","reject","resolve","callbackUUID","uuid","sqlite","stringify","cmd","value","ret","result"],"sourceRoot":""}