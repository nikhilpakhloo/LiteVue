"use strict";(self["webpackChunklite"]=self["webpackChunklite"]||[]).push([[513],{9513:function(t,e,i){i.r(e),i.d(e,{default:function(){return g}});var s=i(1032),o=i(4746),l=function(){var t=this,e=t._self._c;return e("lay-header",{attrs:{showBack:!t.isEditMode,showX:t.isEditMode,tBarColor:"#FFFFFF",txtRight:t.isEditMode?t.$t("common.done"):t.$t("common.edit"),txtTitle:t.$t("collection.title"),onBack:()=>{t.isEditMode?t.isEditMode=!1:t.$router.go(-1)},onRight:t.onClickActionEdit}},[e(s.A,{staticClass:"pt-1 px-5 pb-13 lay-body",attrs:{column:""}},[e(s.A,{staticClass:"lay-pics",attrs:{row:"",wrap:""}},[t._l(t.items,(function(s,o){return e("c-coll",{key:o,attrs:{name:1==s.favorite?t.$t("collection.like"):s.collectionName,src:s.thumbName+`?${t.filterVer}`,isEditMode:1!=s.favorite&&t.isEditMode,onDel:()=>t.onClickActionDel(s),onClick:()=>{t.isEditMode||t.pushRouter({name:"collList",params:{seq:s.collectionId}})}}},[1==s.favorite?e("img",{staticClass:"ic-heart",attrs:{src:i(768)}}):t._e()])})),e("c-coll",{directives:[{name:"show",rawName:"v-show",value:!t.isEditMode,expression:"!isEditMode"}],attrs:{name:t.$t("collection.reg"),onClick:()=>t.pushRouter({name:"collReg"}),empty:!0}},[e(s.A,{directives:[{def:o.A,name:"ripple",rawName:"v-ripple"}],staticClass:"lay-add",attrs:{"align-center":"","justify-center":""}},[e("img",{attrs:{src:i(588)}})])],1)],2)],1)],1)},n=[],r=(i(4114),i(9358)),c=i(5008),a=i(2511),d={components:{CColl:r.A},data(){return{isEditMode:!1,isGetingItems:!1,items:[],pageNo:1,allCount:0}},computed:{},watch:{},created(){window.addEventListener("scroll",this.handleScroll)},mounted(){this.getItems()},destroyed(){window.removeEventListener("scroll",this.handleScroll)},methods:{async getItems(t=1){this.isGetingItems||(this.isGetingItems=!0,await c.A.request(t).then((e=>{this.isGetingItems=!1,this.pageNo=t,1==t&&(this.items.splice(0,this.items.length),this.allCount=0,e.list&&1==e.list.length&&"1"==e.list[0].favorite&&!e.list[0].mediaId)||(this.allCount=e.allCount,this.items.push(...e.list),setTimeout((()=>{var t=document.children[0];this.checkNext(t)}),300))})).catch((()=>{this.isGetingItems=!1})))},handleScroll(t){let e=t.target.children[0];this.checkNext(e)},checkNext(t){this.items.length<this.allCount&&t&&t.scrollHeight-t.clientHeight-80<t.scrollTop&&this.getItems(this.pageNo+1)},onClickActionEdit(){this.isEditMode=!this.isEditMode,this.isEditMode||this.getItems()},async onClickActionDel(t){if(this.isGetingItems)return;this.isGetingItems=!0;let e=await a.A.request([t.collectionId]);this.isGetingItems=!1,e.isSuccess?(this.items.splice(this.items.indexOf(t),1),this.showToast(this.$t("error.del-comp"))):this.showToast(this.$t("error.error"),!1,!1)}}},h=d,u=i(1656),m=(0,u.A)(h,l,n,!1,null,"7aff82f8",null),g=m.exports},2511:function(t,e,i){var s=i(8414),o=i.n(s),l=i(7488);const n={request:async t=>{let e={isSuccess:!1,errorMsg:"",data:null};if(!t.length)throw"no data";let i=`   \n            DELETE FROM \n                TB_COLLECTION\n            WHERE\n                collectionId IN (${t})\n        `;try{var s=await new Promise(((t,e)=>{const s=`API_GETINFO_CALLBACK_${o()().replace(/-/gi,"")}`;l.A.sqlite(JSON.stringify({cmd:"runQuery",query:i}),s),window[`${s}`]=i=>{try{i?t(i):e()}catch(o){e(o)}delete window[`${s}`]}}));if(JSON.parse(s).result)return new Promise(((i,s)=>{let n=`\n                        DELETE FROM \n                            TB_COLLECTION_MEDIA \n                        WHERE \n                            collectionId IN (${t})\n                    `;const r=`API_GETID_CALLBACK_${o()().replace(/-/gi,"")}`;l.A.sqlite(JSON.stringify({cmd:"runQuery",query:n}),r),window[`${r}`]=t=>{try{if(t){const s=JSON.parse(t);e.isSuccess=s.result,e.errorMsg=s.error,e.data=s.data&&s.data.length>0?s.data[0]:null,i(e)}else s()}catch(o){s(o)}delete window[`${r}`]}}));throw"error"}catch(n){throw n}}};e.A=n},588:function(t,e,i){t.exports=i.p+"img/ic-plus-g.4b1ed75f.svg"}}]);
//# sourceMappingURL=513.79e572b0.js.map