"use strict";(self["webpackChunklite"]=self["webpackChunklite"]||[]).push([[996],{1996:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var i=s(5420),n=s(1032),l=function(){var t=this,e=t._self._c;return e("lay-header",{attrs:{showBack:!0,tBarColor:"#FFFFFF",txtTitle:t.$t("gallery.my-pic"),onRight:t.onClickActionComp,isGetingItems:t.isGetingItems}},[e(n.A,{staticClass:"bar-right",attrs:{slot:"right"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.onClickActionFilter.apply(null,arguments)}},slot:"right"},[e("img",{attrs:{src:s(7940)}}),e("span",{staticClass:"txt-right"},[t._v(t._s(t.$t("common.btn-filter")))])]),e(n.A,{staticClass:"lay-body",attrs:{column:""}},[t.selectItems.length?[e("span",{staticClass:"px-5 my-2 txt-cnt"},[t._v(t._s(t.$t("gallery.sel-cnt",{count:t.selectItems.length})))]),e(n.A,{staticClass:"lay-select"},t._l(t.selectItems,(function(n,l){return e(i.A,{key:l,staticClass:"img-select",attrs:{width:64,height:64,"max-width":64,"max-height":64,src:n.thumbName+`?${t.filterVer}`}},[e("img",{staticClass:"ic-x",attrs:{src:s(3123)},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),(()=>{t.selectItems.splice(l,1)}).apply(null,arguments)}}})])})),1)]:t._e(),e(n.A,{staticClass:"flex-grow-0 pb-5 mt-3",attrs:{wrap:"",row:""}},t._l(t.items,(function(s,i){return e("c-pic",{key:i,attrs:{editMode:!0,src:("VIDEO"==s.fileType?s.thumbName:s.fileName)+`?${t.filterVer}`,isVideo:"VIDEO"==s.fileType,duration:s.videoTime,select:t.selectItems.indexOf(s)>-1?t.selectItems.indexOf(s)+1:null,onClick:()=>t.onClickActionSelect(s),mediaId:s.mediaId,isLike:"Y"==s.likeYn,isFilter:"1"==s.filterd,isMemo:s.memo.title||s.memo.memo}})})),1)],2)],1)},c=[],r=(s(4114),s(1877)),o=s(3776),a={props:["title"],components:{CPic:r.A},data(){return{selectItems:[],items:[],pageNo:1,allCount:0,isGetingItems:!1}},computed:{},watch:{},created(){window.addEventListener("scroll",this.handleScroll),window.onFilterComplete=t=>{t&&(this.showToast(this.$t("error.filter-comp"),!1,!1),this.$store.commit("filterVer",this.filterVer+1),this.$router.go(-1))}},mounted(){this.getItems()},destroyed(){window.removeEventListener("scroll",this.handleScroll),delete window.onFilterComplete},methods:{async getItems(t=1){this.isGetingItems||(this.isGetingItems=!0,this.pageNo=t,await o.A.request(this.pageNo).then((t=>{1==this.pageNo&&this.items.splice(0,this.items.length),this.items.push(...t.list),this.allCount=t.allCount,this.isGetingItems=!1,this.items.forEach((t=>{try{this.$set(t,"memo",JSON.parse(t.memo.replace(/\n/g,"\\n")))}catch(e){}})),setTimeout((()=>{var t=document.children[0];this.checkNext(t)}),300)})).catch((()=>{this.isGetingItems=!1})))},handleScroll(t){let e=t.target.children[0];this.checkNext(e)},checkNext(t){this.items.length<this.allCount&&t&&t.scrollHeight-t.clientHeight-80<t.scrollTop&&this.getItems(this.pageNo+1)},onClickActionComp(){this.showToast("준비중입니다."),this.pushRouter({name:"collList",params:{seq:1}})},onClickActionSelect(t){this.selectItems.indexOf(t)>-1?this.selectItems.splice(this.selectItems.indexOf(t),1):this.selectItems.push(t)},onClickActionFilter(){this.selectItems.length>this.FILTER_MAX_SIZE?this.showToast(this.$t("error.filter-cnt-error",{count:this.FILTER_MAX_SIZE}),!1,!1):this.nativeBridge.showFilterView(this.selectItems,"onFilterComplete")}}},m=a,h=s(1656),d=(0,h.A)(m,l,c,!1,null,"321a4550",null),u=d.exports},3776:function(t,e,s){var i=s(8414),n=s.n(i),l=s(7488),c=s(7334);const r={request:async(t=1,e=20,s,i)=>{let r={isSuccess:!1,errorMsg:"",list:null,allCount:0},o="\n            SELECT \n                COUNT(*) AS cnt \n            FROM \n                TB_MEDIA \n            WHERE \n                deleted = 0\n        ",a="\n            SELECT \n               *\n            FROM \n               (\n                    SELECT \n                        m.*,\n                        CASE WHEN(COUNT(cm.collectionMediaId) > 0) THEN 'Y' ELSE 'N' END as likeYn\n                    FROM \n                        TB_MEDIA m\n                    LEFT JOIN\n                        TB_COLLECTION_MEDIA cm\n                    ON\n                        m.mediaId = cm.mediaId \n                        AND cm.collectionId = 1 \n                        AND cm.deleted = 0\n                    GROUP BY\n                        m.mediaId\n                )\n            WHERE \n                deleted = 0\n        ";if(s&&s.length&&s.forEach((t=>{a+=` AND ${t.key} = '${t.val}' `,o+=` AND ${t.key} = '${t.val}' `})),i){let t=`\n                AND mediaId NOT IN (\n                    SELECT \n                        mediaId\n                    FROM\n                        TB_COLLECTION_MEDIA\n                    WHERE \n                        deleted = 0\n                    AND \n                        collectionId = ${i}\n                )\n            `;a+=t,o+=t}a+=`   \n            ORDER BY \n                createDate DESC\n            LIMIT ${e} OFFSET ${e*(t-1)}\n        `;try{r.allCount=await c.A.request(o,"cnt")}catch(m){return Promise.reject(m)}return new Promise(((t,e)=>{const s=`API_GETLIST_CALLBACK_${n()().replace(/-/gi,"")}`;l.A.sqlite(JSON.stringify({cmd:"selectQuery",query:a}),s),window[`${s}`]=i=>{try{if(i){const e=JSON.parse(i);r.isSuccess=e.result,r.errorMsg=e.error,r.list=e.data,t(r)}else e()}catch(m){e(m)}delete window[`${s}`]}}))}};e.A=r},7940:function(t,e,s){t.exports=s.p+"img/ic-pen-b.969d6b4f.svg"},3123:function(t,e,s){t.exports=s.p+"img/ic-x-thumb.c2abf8bf.svg"}}]);
//# sourceMappingURL=996.96835319.js.map